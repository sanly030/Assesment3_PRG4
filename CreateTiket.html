<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Create Tiket</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
    <!-- <script src="create.js"></script> -->
</head>

<body>
    <br />
    <br />
    <div class="container">
        <form id="input">

            <h3>Create Tiket</h3>
            <div class="mb-2">
                <label class="form-label">Nama</label>
                <input type="text" id="tik_nama" class="form-control" required>
            </div>

            <div class="mb-2">
                <label class="form-label">Harga</label>
                <input type="number" id="tik_harga" class="form-control" required>
            </div>

            <div class="mb-2">
                <label class="form-label">Kuota</label>
                <input type="number" id="tik_kuota" class="form-control" required>
            </div>

            <input type="hidden" id="tik_status" value="1">
            <button type="submit" class="btn btn-primary mt-3">Simpan</button>
            <button type="button" class="btn btn-warning mt-3"
                onclick="window.location.href='ReadTiket.html'">Kembali</button>
            <div id="result" class="mt-3"></div>
        </form>
    </div>

    <script>

        document.getElementById("input").addEventListener("submit", async function (e) {
            e.preventDefault();

            const tiket = {
                tik_nama: document.getElementById("tik_nama").value.trim(),
                tik_harga: parseInt(document.getElementById("tik_harga").value),
                tik_kuota: parseInt(document.getElementById("tik_kuota").value),
                tik_status: 1
            };

            try {
                const res = await fetch("https://asm.roniprsty.com/tiket/create.php", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(tiket),
                });

                const data = await res.json();
                document.getElementById("result").innerHTML = `<div class="alert alert-${data.status === "success" ? "success" : "danger"}">${data.message}</div>`;

                if (data.status === "success") {
                    this.reset();
                }
            } catch (err) {
                document.getElementById("result").innerHTML = `<div class="alert alert-danger">Gagal menghubungi server</div>`;
            }
        });
    </script>
</body>

</html>